\chapter{実験}
ここでは、提案手法と既存手法との比較実験を行い、提案手法の長所を示す。

\section{データセット}
本実験では、データセットとしてDirectory of Useful Decoys (DUD-E)\cite{Mysinger2012}を用いた。DUD-Eは102種類のターゲットについて、それぞれタンパク質・正例化合物・負例化合物を用意している。表\ref{table:dude}にターゲットごとの化合物数、正例と負例の比率の最小値、最大値、平均値を、図\ref{fig:dude_hist_comp}に総化合物数の分布を示す\todo{ヒストグラム作成}。各ターゲットの詳細については付録\ref{appendix:dude}に記載する。

\begin{table}[htb] \centering
	\caption{DUD-Eのターゲットの化合物}
	\label {table:dude}
	\begin{tabular}{c|ll|}
			&総化合物数	&正/負例の比率	\\ \hline
	最大値	&			&				\\
	平均値	&			&				\\
	最小値	&			&				\\ \hline
	\end{tabular}
\end{table}
	
\section{予測精度の評価指標}
バーチャルスクリーニングでは一般的に正例と負例の比が非常に偏っている。
そのため単純なprecisionやrecallを用いた評価を行うことができず、以下の2種類の評価指標が多く用いられている。
本実験においても、この2種類を予測精度の評価指標として用いる。

\subsection{ROC-AUC}
Receiver Operating Characteristic(ROC)曲線の曲線下面積(Area Under the Curve, AUC)。
ROC曲線に必要なFP-RateとTP-Rateの数式を示し、算出例を示す。\todo{卒論から文章をひっぱってくる}

\subsection{EF (EnrichmentFactor)}
数式と算出例を示す。ROC-AUCと同じ例を用いるようにする。



\section{計算環境}
TSUBAME Thinノード\todo{先輩の修論の記述を参考にする}


\section{比較対象}
本提案手法はドッキングに基づくフィルタリング手法であるため、同様の用途に用いられているglide HTVS（高速）モードを比較対象として用いる。
また、フィルタリングとしての性能を評価するために、glide SP（通常）モードによる化合物ドッキングシミュレーションと組み合わせた評価も行うため、
計算時間などの評価に関してはglide SPモードも比較対象とする。


\section{実験結果}

\subsection{ドッキングにかかる計算時間}
はじめに、提案手法の計算速度を評価する。提案手法は\ref{subsec:decomposition}節で述べたように化合物数が多ければ多いほど
計算コストの削減幅が増幅される手法であるため、DUD-E 102ターゲット全てでの所要計算時間の平均以外に、
総化合物数が最小である\r{xxx}ターゲット、総化合物数が中央値である\r{xxx}ターゲット、総化合物数が最大である\r{xxx}ターゲット３種類に
ついては独立して結果を示す。

結果は表\ref{table:calc_time}の通りであり、提案手法は既存手法であるglide HTVSと比べて平均して9倍（SPモード利用時）から
15倍（HTVSモード利用時）の速度向上を達成している。

\begin{table}[htb] \centering
	\caption{ドッキング計算時間の比較}
	\label{table:calc_time}
	\begin{tabular}{c|rr|rrrr|}
							&	\multirow{3}{*}{総化合物数}	&\multirow{3}{*}{\shortstack{フラグメント\\種類数}}	&\multicolumn{4}{c|}{計算時間 [CPU sec.]}									\\
							&							&											&\multicolumn{2}{c}{化合物ドッキング}	&\multicolumn{2}{c|}{フラグメントドッキング}	\\
							&							&											&glide SP		&glide HTVS		&glide SP 		&glide HTVS			\\ \hline
全ての平均					&nn							&nn											&236,156			&14,813			&1,673		&987					\\
\shortstack{最小ターゲット}		&nn							&nn											&nn				&				&				&					\\
\shortstack{中央値ターゲット}	&nn							&nn											&nn				&				&				&					\\
\shortstack{最大ターゲット}		&nn							&nn											&nn				&				&				&					\\
	\end{tabular}
\end{table}

\r{現在ここまで記述済み}

\subsection{予測精度}
ここでは単独手法としての精度を示す。ROC曲線はAppendixとして載せていることを記述
\comment{ROC曲線も本文に示す。良い/悪いの評価をする際に必要になるため。（大上先生）}

\begin{table}[htb] \centering
	\caption{提案手法の予測精度}
	\label{tb:filtering_accuracy}
	\begin{tabular}{c|c|lllll|}
	\multirow{2}{*}{手法}				&フラグメント		&\multirow{2}{*}{ROC-AUC}	&\multicolumn{4}{c}{Enrichment Factor}	\\
									&ドッキング		&						&EF(1\%)	&EF(2\%)	&EF(5\%)	&EF(10\%)	\\ \hline
	\multirow{2}{*}{総和(score\_sum)}		&glide 通常モード	&						&		&		&		&			\\
									&glide 高速モード	&						&		&		&		&			\\
	\multirow{2}{*}{最良値(score\_max)}	&glide 通常モード	&						&		&		&		&			\\
									&glide 高速モード	&						&		&		&		&			\\
	\multirow{2}{*}{混合(maxsumBS)}		&glide 通常モード	&						&		&		&		&			\\
									&glide 高速モード	&						&		&		&		&			\\ \hline
	\multicolumn{2}{c|}{従来手法(glide 高速モード)}			&						&		&		&		&			\\ \hline
	\end{tabular}
\end{table}

\subsection{filteringと通常のドッキングとを合わせた場合の計算時間および精度}
filtering時に何\%の化合物を残すか、などの議論と合わせて、精度と速度のバランスを示す。
\comment{トレードオフを示すのについて、フィルタリングのパーセンテージをもっと振るべきでは？5, 10, 20, 30, 40, 50\%のように。（大上先生）}
\begin{figure}[htp]
 \begin{center}
  \fig[width=0.99\hsize]{./fig/result/性能vs時間.eps}
  \caption{計算時間と精度のトレードオフ}
  \label{fig:trade_off}
 \end{center}
\end{figure}
