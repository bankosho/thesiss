\chapter{ドッキングシミュレーションによる薬物候補化合物の選別}
この章ではドッキングシミュレーションに基づく化合物の選別手法を説明し，既存の化合物フィルタリング手法を紹介する．

\section{SBVS（Structure-Based Virtual Screening）とは}
バーチャルスクリーニング（Virtual Screening, VS）とは，コンピュータを用い，データベースに存在する化合物について，
創薬標的となっているタンパク質の活性部位への結合のしやすさを仮想的に（Virtual）評価，選別（Screening）することを指す．
化合物の評価・選別を創薬標的のタンパク質や化合物の立体構造に基づいて行う手法のことをSBVS（Structure-Based Virtual Screening）と呼ぶ．
このSBVSは，化合物の評価・選別を既知の創薬標的タンパク質へ結合する化合物（リガンド, ligand）を用いて行う
LBVS（Ligand-Based Virtual Screening）と比べて
\begin{itemize}
\item 既知のリガンド情報を必要とせず
\item 既知のリガンドにとらわれない，多様な薬剤候補化合物を得ることができる
\end{itemize}
という長所を持っている．

\section{タンパク質-化合物ドッキングシミュレーション}
SBVSにおける化合物の評価にはタンパク質-化合物ドッキングシミュレーションが一般に用いられる．
ドッキングシミュレーションは，1つのタンパク質の立体構造と1つの化合物の立体構造を入力として，化合物がタンパク質中でどのような構造をとると
エネルギー的に最も安定であるかという最適化問題を解き，最安定構と考えられる化合物の構造とその時のスコアを近似的に求め
出力する（図\ref{fig:docking}）．
\begin{figure}[tb]
 \begin{center}
  \fig[width=0.9\hsize]{./fig/background/docking_image.eps}
  \caption{ドッキングシミュレーションのイメージ}
  \label{fig:docking}
 \end{center}
\end{figure}
この得られたスコアを直接，あるいは何らかの形で変換を行った評価値を用いて複数の化合物の選別を行う．

このドッキングシミュレーションを行うツールは
Glide\cite{Friesner2004}, eHiTS\cite{Zsoldos2007}などの有償ソフトウェア，AutoDock\cite{Morris2009}などのオープンソースソフトウェアを
始めとして，有償無償問わず様々開発されている．
表\ref{table:docking_tools_eg}に主なドッキングシミュレーションソフトウェアを示す．

\begin{table}[htb] \centering
	\caption{主なドッキングシミュレーションソフトウェア}
	\label{table:docking_tools_eg}
	\begin{tabular}{llcl}
	\hline
	\multicolumn{1}{c}{ソフトウェア名}	&\multicolumn{1}{c}{論文}			&\multicolumn{1}{c}{有償/無償}	&\multicolumn{1}{c}{ホームページ}	\\ \hline
	AutoDock					&(Morris {\it et al.}, 2009)\cite{Morris2009}												&無償									&\url{http://autodock.scripps.edu/}	\\ 
	AutoDock Vina				&(Trott  {\it et al.}, 2010)\cite{Trott2010}																											&無償									&\url{http://autodock.scripps.edu/}	\\ 
	DOCK							&(Ewing {\it et al.}, 2001)\cite{Ewing2001}																				&無償									&\url{http://dock.compbio.ucsf.edu/}	\\
	eHiTS							&(Zsoldos {\it et al.}, 2007)\cite{Zsoldos2007}											&有償									&\url{http://www.simbiosys.ca/ehits/}	\\
	FlexX							&(Rarey {\it et al.}, 1996)\cite{Rarey1996}																											&有償									&\url{http://www.biosolveit.de/flexx}	\\
	Glide							&(Friesner {\it et al.}, 2004)\cite{Friesner2004}													&有償									&\url{http://www.schrodinger.com/Glide/}	\\
	GOLD							&(Jones {\it et al.}, 1997)\cite{Jones1997}																				&有償									&\url{http://www.ccdc.cam.ac.uk/}	\\
	ICM								&(Abagyan {\it et al.}, 1993)\cite{Abagyan1993}																											&有償									&\url{http://www.molsoft.com/docking.html}	\\ \hline
	\end{tabular}
\end{table}


\subsection{ドッキングシミュレーションの要素}\label{subsec:docking_elements}
SBVSの薬物候補化合物の選別はドッキングシミュレーションによって得られたスコアを基に行われるため算出されるスコアは重要となるが，
後述するように探索空間が非常に広く，さらに最適化を行うべきスコア値も一般的に探索空間内で単調ではないため，
厳密な最適スコアを求めることは事実上不可能である．そのため，ドッキングシミュレーションにおいては
\begin{itemize}
\item 非常に広い\b{探索空間}からなる最適化問題で良い準最適解を効率良く見つける\b{探索アルゴリズム}
\item 適度に高速に計算でき，タンパク質-化合物の結合構造の良し悪しを適切に見積もる\b{スコア関数}
\end{itemize}
の2つが非常に重要であり，これらは1982年に最初のドッキングシミュレーションツールであるDOCK\cite{Kuntz1982}が開発されてより，
様々なグループによって研究が進められている．

\subsubsection{探索空間}
ドッキングシミュレーションでは，タンパク質の位置を固定として，化合物がタンパク質とどのような構造をとると良いかを探索する．
この際，探索しなければならない空間は化合物の並進運動および回転運動の6次元に加え，化合物の内部に回転可能な結合を持つため
化合物の内部自由度を考慮しなければならない（図\ref{fig:docking_freedom}）．
すでに上市され利用されている薬剤が収録されたZINC Drug Databaseに登録されている2924個の
薬剤化合物の内部自由度の平均は4.61であり，これが計算量に大きな影響を及ぼす．

\begin{figure}[tb]
 \begin{center}
  \fig[width=0.9\hsize]{./fig/background/ドッキングの次元.pdf}
  \caption{ドッキングシミュレーションの探索空間}
  \label{fig:docking_freedom}
 \end{center}
\end{figure}


\subsubsection{探索アルゴリズム}
前述のように探索空間の広さのために大域最適解を求めることは困難であるため，より良い局所最適解を求めるための
工夫がツール毎になされている．
\begin{itemize}
\item Glide\cite{Friesner2004}\\
	段階的な全探索を行うことで局所最適解を得る．具体的には，最初の段階では化合物を球体に近似しての位置が良いかどうかの
	見積もりから始め，徐々に化合物の近似を厳密なものにしていく．それぞれの段階で上位の位置・構造のみを残し次の段階へ進めることで，
	全探索の空間を現実的な量に制限し，探索を完了させる（図\ref{fig:glide_flowchart}）．
\item eHiTS\cite{Zsoldos2007}\\
	化合物を部分構造に分割し，部分構造にとって良い構造をそれぞれ多数記録し，ノードにする．
	その後，2つの部分構造が構造を構成するのに適度な距離，適度な向きになっているノード間にエッジを張り，
	作成されたグラフに関して最大クリーク問題を解くことで適切な構造を得る（図\ref{fig:eHiTS_clique}）．
\item AutoDock\cite{Morris2009}\\
	並進運動位置，回転運動位置，化合物の内部回転角を用いた遺伝的アルゴリズム（Genetic algorithm, GA）で
	より良い局所最適解を得る（図\ref{fig:AutoDock_gene}）．
\end{itemize}

\begin{figure}[htb]
 \begin{center}
  \fig[width=0.4\hsize]{./fig/background/glide.png}
  \caption{Glideのワークフロー\cite{Friesner2004}}
  \label{fig:glide_flowchart}
 \end{center}
\end{figure}
\begin{figure}[htb]
 \begin{center}
  \fig[width=0.6\hsize]{./fig/background/eHiTS_clique.eps}
  \caption{eHiTSのクリーク探索}
  \label{fig:eHiTS_clique}
 \end{center}
\end{figure}
\begin{figure}[htb]
 \begin{center}
  \fig[width=0.4\hsize]{./fig/background/AutoDock_gene.eps}
  \caption{AutoDockのGAで用いる変数群}
  \label{fig:AutoDock_gene}
 \end{center}
\end{figure}


\subsubsection{スコア関数}
探索アルゴリズムがどれほど良く，大域最適なスコアを得たとしても，そのスコアがタンパク質と化合物との物理的な結合エネルギーとの相関が
なければ意味がない．しかし，結合エネルギーを厳密に計算するには量子化学計算が必要となり，実用的な時間では計算が完了しないので，
近似計算が必要となる．したがって，スコア関数に関しても様々な提案がなされている．
\begin{enumerate}
\item 物理化学的スコア関数（Force field）\\
	静電相互作用力やファンデルワールス力など，原子と原子との間に働く物理化学的な力を元としたスコア関数であり，
	考慮する物理的な項や，原子に対するパラメータが異なるなどによって多数のスコア関数が提案されている
	\cite{Morris1998, Ewing2001, Jones1997}．
\item 経験的スコア関数（Empirical）\\
	水素結合など物理化学的な要素に基づきつつも，実験から得られたタンパク質と化合物との結合エネルギーを再現できるように
	関数の係数ではなく関数そのものをパラメータ化することによって作成されたスコア関数である\cite{Wang2002, Gehlhaar1995, Eldridge1997}．
\item 統計的スコア関数（Knowledge-based）\\
	タンパク質と化合物との複合体構造はProtein Data Bank（PDB）\cite{Berman2000}に多数登録されており，
	この複合体構造におけるそれぞれの原子種間の距離や角度の確率を計算し，それをエネルギーに変換することで作成されたスコア関数である
	\cite{Muegge2006, Xue2010, Gohlke2000, Huang2010}．この手法では，どの複合体構造のセットを用いるかによってスコア関数が変化するため，一部のターゲットに特化した
	スコア関数なども作成されている\cite{Seifert2009}．
\end{enumerate}

%それぞれの具体的なスコア関数名，もしくはドッキングシミュレーションソフトウェア名を表\ref{table:scoring_function}に示す．
%\todo{table:scoring\_function, Cheng2012の表をこちらに作成する}
%\begin{figure}[h]
% \begin{center}
%  \fig[width=0.8\hsize]{./fig/background/scoring_functions.png}
%  \caption{作成する表(Cheng {\it et al.}, 2012より)}
%  \label{fig:scoring_function}
% \end{center}
%\end{figure}

\subsection{ドッキングシミュレーションの問題点}\label{subsec:docking_problem}
\ref{subsec:docking_elements}節に述べたように，ドッキングシミュレーションツールはそれぞれ高速化のための工夫を凝らしているが，
それでも不十分であるのが現状である．
例えば，1コアを用いて１つの化合物を評価するのにGlideで0.2--2.4分程度\cite{Friesner2004}，eHiTSは最速で数秒\cite{Zsoldos2007}を要すると
述べられている．この速度で1,000万化合物を選別しようとすると10秒で１つの化合物を評価できたとしても1,200 CPU daysもの時間を必要とする．
このような場合に一般的に用いられる手段である大規模計算化に関しても，GlideやeHiTSはライセンス式の有償ソフトウェアであるために，
大量のライセンスを購入する必要があり現実的ではない．
一方，AutoDockはライセンスが必要なく大規模並列計算が可能であるが，Glideと比べて250倍程度も遅いという
報告がなされている\cite{Tuccinardi2010}．AutoDockはオープンソースソフトウェアであるため，GPU実装による高速化も提案されているが，
遺伝的アルゴリズムやスコア関数の計算が最大50倍程度高速になる程度であり\cite{Kannan2010}，Glideに及ばない．

\begin{table}[htb] \centering
	\caption{ドッキングシミュレーションソフトウェアの計算速度}
	\label{table:docking_tools}
	\begin{tabular}{c|cl}
	\hline
	ソフトウェア名					&有償/無償				&\multicolumn{1}{c}{1 CPUでの計算速度} 					\\ \hline
	Glide							&有償						&10--150 sec/compound\cite{Friesner2004}				\\
	eHiTS							&有償						&$<$10 sec/compound（最速）\cite{Zsoldos2007}			\\
	AutoDock					&無償						&Glideの約250倍の計算時間\cite{Tuccinardi2010}		\\ \hline
%	\multirow{2}{*}{AutoDock}	&\multirow{2}{*}{無償}	&500 sec/compound\cite{Trott2010} ,						\\ 	
%									&							&Glideの約250倍の時間を要する\cite{Tuccinardi2010}	\\ \hline	
	\end{tabular}
\end{table}

\section{化合物のフィルタリング}
ドッキングシミュレーションは大きな計算量を必要とするために，1,000万個もの化合物から薬物候補化合物を選別しようとすることが非常に難しい
ことを\ref{subsec:docking_problem}節で述べた．このため，ドッキングシミュレーションを高速化するのではなく，
ドッキングシミュレーションの入力とする化合物の数をあらかじめ減ずることで総計算時間を削減するという戦略が創薬研究では良く用いられる．

\subsection{既存のフィルタリング手法}\label{subsec:existing_filtering}
既存のフィルタリング手法は大きく分けて1. 化合物の物理的特徴に基づくフィルタリング，2. 化合物の構造に基づくフィルタリング，3. ドッキングベースのフィルタリングの3種類が存在している．
\begin{enumerate}
\item \b{化合物の物理的特徴に基づくフィルタリング}\\
	分子量や水溶性か油溶性かを示す分配係数（LogP）など，
	化合物の物理的な特徴を示す値は体内での吸収などの上で重要な値であることから，
	これらの値を用いたフィルタリングが提案されている．
	\begin{itemize}
	\item \b{リピンスキーの法則\cite{Lipinski1997}}\\
		経口薬として優れた薬物の物理的特徴を4つの法則にまとめたもの
	\item \b{Quantitative Estimate of Druglikeness（QED）\cite{Bickerton2012}}\\
		既知薬剤の物理的な値からヒストグラムを作成し，化合物の薬物らしさ（Druglikeness）のスコアを付ける手法
	\end{itemize}
\item \b{化合物の構造に基づくフィルタリング}\\
	タンパク質の活動の阻害はタンパク質や化合物１分子単位の非常に微視的なメカニズムによって発生しており，
	したがって化合物の分子構造はタンパク質との複合体を形成する上で非常に重要な情報である．
	特に，構造が似ている化合物同士は同じタンパク質との複合体を形成することが多く，
	この性質を利用したフィルタリング手法が複数提案されている．
	\begin{itemize}
	\item \b{フィンガープリント（fingerprint）を用いたフィルタリング\cite{Nilakantan1993}}\\
		化合物の分子構造式を数百～数千のあらかじめ定めた局所構造が存在するか否かのバイナリである
		フィンガープリントに変換し，これを用いて既知の薬剤やタンパク質の阻害剤にどれほど近いかを判定する手法
	\item \b{ファーマコフォア（pharmacophore）を用いたフィルタリング\cite{Parenti2003}}\\
		分子の構造式のみではなく，化合物の立体構造も用いて化合物の類似性を評価する手法
	\end{itemize}
\item \b{ドッキングシミュレーションベースのフィルタリング}\\
	\ref{subsec:docking_problem}節で述べた通り，ドッキングシミュレーションは一般的に計算コストが高くフィルタリングには適していないが，
	Glideには化合物の構造について強い仮定を置くことで計算を簡易化し，通常ドッキングモード（SPモード）の
	10倍程度の速度\cite{GlideHomePage}で計算を完了させる高速ドッキングモード（HTVSモード）が存在する．
	このモードをフィルタリングとして利用し，フィルタリング後の化合物群に対してSPモードによる
	ドッキングシミュレーションを行うという手法が用いられることがある\cite{Fujimoto2008}．
\end{enumerate}

\subsection{既存手法の問題点}
\ref{subsec:existing_filtering}節で述べたように，既存のフィルタリング手法は多く存在するものの，
以下の2点からこれらの手法は改善する余地が残されている．
\begin{itemize}
\item 化合物の物理的特徴や化合物の構造に基づくフィルタリング手法は帰納的な手法であり，
	標的タンパク質を狙った既知の薬剤や阻害剤が必須となる．さらに既知の薬剤や阻害剤を利用できたとしても，
	化合物の類似性を利用する手法であるためにフィルタリング結果の化合物が既知の化合物に似てしまうという問題がある．	
\item Glideの高速ドッキングモードはドッキングシミュレーションとしては高速であるが，それでも1化合物1秒程度を要する．
	1,000万件の化合物のフィルタリングを行う場合1 CPU利用で4か月程度の期間を要してしまうため，この速度は十分とは言えない．
\end{itemize}
