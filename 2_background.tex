\chapter{ドッキングシミュレーションによる薬物候補化合物の選別 (Structure-based Virtual Screening, SBVS)}
この章ではドッキングシミュレーションに基づく化合物の選別手法を説明し、既存の化合物フィルタリング手法を紹介する。

\section{SBVSとは}
バーチャルスクリーニング（Virtual Screening, VS）とは、コンピュータを用い、データベースに存在する化合物について、
創薬標的となっているタンパク質の活性部位への結合のしやすさを仮想的に（Virtual）評価、選別（Screening）することを指す。
化合物の評価・選別を創薬標的のタンパク質や化合物の立体構造に基づいて行う手法のことをSBVSと呼ぶ。
このSBVSは、化合物の評価・選別を既知の創薬標的タンパク質へ結合する化合物(リガンド, ligand)を用いて行う
LBVS(Ligand-based Virtual Screening)と比べて
\begin{itemize}
\item 既知のリガンドを必要とせず
\item 既知のリガンドにとらわれない、多様な薬剤候補化合物を得ることができる
\end{itemize}
という長所を持っている。

\section{化合物-タンパク質ドッキングシミュレーション}
SBVSにおける化合物の評価には化合物-タンパク質ドッキングシミュレーションが一般に用いられる。
ドッキングシミュレーションは、1つのタンパク質の立体構造と1つの化合物の立体構造を入力として、化合物がタンパク質中でどのような構造をとると
エネルギー的に最も安定であるかという最適化問題を解き、最安定であると考えられる化合物の構造とその時のスコアを
出力する（図\ref{fig:docking}）。\todo{dockingを説明する図を作成}
SBVSにおける複数の化合物の選別にはドッキングシミュレーションによって得られたスコアを直接用いるか、もしくは得られたスコアを何らかの形で
変換し、評価値がより良かった化合物を薬物候補化合物として残す。

Glide\cite{Friesner2004}, eHiTS\citetodo{}などの有償ソフトウェア、Autodock\citetodo{}などのオープンソースウェアを始めとして、
有償無償問わず様々なドッキングシミュレーションツールが開発されている。

\subsection{ドッキングシミュレーションの要素}\label{subsec:docking_elements}
SBVSの薬物候補化合物の選別はドッキングシミュレーションによって得られたスコアを基に行われるため算出されるスコアは重要となるが、
後述するように探索空間が非常に広く、さらに最適化を行うべきスコア値も一般的に探索空間内で単調ではないため、
厳密な最適スコアを求めることは事実上不可能である。そのため、ドッキングシミュレーションにおいては
\begin{itemize}
\item 非常に広い探索空間からなる最適化問題で良い準最適解を効率良く見つける探索アルゴリズム
\item 適度に高速に計算でき、タンパク質-化合物の結合構造の良し悪しを適切に見積もるスコア関数
\end{itemize}
の2つは非常に重要であり、これらは1982年に最初のドッキングシミュレーションツールであるDOCK\citetodo{}が開発されてより、
様々なグループによって研究が進められている。

\subsubsection{探索空間}
ドッキングシミュレーションでは、タンパク質の位置を固定として、化合物がタンパク質とどのような構造をとると良いかを探索する。
この際、探索しなければならない空間は化合物の並進運動および回転運動の6次元に加え、化合物の内部に回転可能な結合を持つため
化合物の内部自由度を考慮しなければならない（図\ref{fig:docking_freedom}）。
この内部自由度はZINC Drug Database に登録されている2924個の薬剤化合物で平均\r{x.xx}と少なくなく、計算量に大きな影響を与える。

\subsubsection{探索アルゴリズム}
前述のように探索空間の広さのために大域最適解を求めることは困難であるため、より良い局所最適解を求めるための
工夫がツール毎になされている。
\begin{itemize}
\item Glide\\
	段階的な全探索を行うことで局所最適解を得る。具体的には、最初の段階では化合物を球体に近似しての位置が良いかどうかの
	見積もりから始め、徐々に化合物の近似を厳密なものにしていく。それぞれの段階で上位の位置・構造のみを残し次の段階へ進めることで、
	全探索の空間を現実的な量に制限し、探索を完了させる。
	\todo{イメージ図が論文中にあれば載せる}
\item eHiTS\\
	化合物を部分構造に分割し、部分構造にとって良い構造をそれぞれ多数記録し、ノードにする。
	その後、2つの部分構造が構造を構成するのに適度な距離、適度な向きになっているノード間にエッジを張り、
	作成されたグラフに関して最大クリーク問題を解くことで適切な構造を得る。
	\todo{イメージ図が論文中にあれば載せる}
\item Autodock\\
	並進運動位置、回転運動位置、化合物の内部回転角を用いた遺伝的アルゴリズム（Genetic algorithm, GA）でより良い局所最適解を得る。
	\todo{イメージ図が論文中にあれば載せる}
\end{itemize}

\subsubsection{スコア関数}
探索アルゴリズムがどれほど良く、大域最適なスコアを得たとしても、そのスコアがタンパク質と化合物との物理的な結合エネルギーとの相関が
なければ意味がない。しかし、結合エネルギーを厳密に計算するには量子化学計算が必要となり、実用的な時間では計算が完了しないので、
近似計算が必要となる。したがって、スコア関数に関しても様々な提案がなされている。\memo{スコア関数の内容に関してもChang\cite{Cheng2012}が示しているようにForce field, Empirical, Knowledge basedで分類しながら詳細すべきでは}

\subsection{ドッキングシミュレーションの問題点}\label{subsec:docking_problem}
\ref{subsec:docking_elements}節に述べたように、ドッキングシミュレーションツールはそれぞれ高速化のための工夫を凝らしているが、
それでも不十分であるのが現状である。
例えば、1コアを用いて１つの化合物を評価するのにGlideで0.2-2.4分程度\citetodo{glide1}、eHiTSは最速で数秒\citetodo{eHiTS}を要すると
述べられている。この速度で1,000万化合物を選別しようとすると10秒で１つの化合物を評価できたとしても1,200 CPU daysもの時間を必要とする。
このような場合に一般的に用いられる手段である大規模計算化に関しても、GlideやeHiTSはライセンス式の有償ソフトウらェアであるために、
大量のライセンスを購入する必要があり現実的ではない。

一方、AutoDockはライセンスが必要なく、大規模並列計算が可能であるが、Glideと比べて250倍程度も遅いという
報告がなされている\cite{Tuccinardi2010}。AutoDockはオープンソースウェアであるため、GPU実装による高速化も提案されているが、
遺伝的アルゴリズムやスコア関数の計算が最大50倍程度高速になる程度であり\cite{Kannan2010}、Glideに及ばない。

\section{化合物のフィルタリング}
ドッキングシミュレーションは大きな計算量を必要とするために、1,000万もの化合物から薬物候補化合物を選別しようとすることが非常に難しい
ことを\ref{subsec:docking_problem}節で述べた。このため、ドッキングシミュレーションを高速化するのではなく、
ドッキングシミュレーションの入力とする化合物の数をあらかじめ減ずることで総計算時間を削減するという戦略が創薬研究では良く用いられる。

\subsection{既存のフィルタリング手法}
既存のフィルタリング手法は大きく分けて化合物の物理的特徴に基づくフィルタリング、化合物の構造に基づくフィルタリング、ドッキングベースのフィルタリングの3種類が存在している。
\subsubsection{化合物の物理的特徴に基づくフィルタリング}
\todo{Lipinski's rule of five\cite{Lipinski1997}, QED\cite{Bickerton2012}, RDL\cite{Yusof2013}を紹介。少し方向性は違うが。}
\subsubsection{化合物の構造に基づくフィルタリング}
fingerprintベースでのフィルタリングをここに記述。ファーマコフォアもこちらか。
\subsubsection{ドッキングベースのフィルタリング}
glide HTVSがフィルタリングに利用されるケースを記述。

\subsection{既存手法の問題点}
以下の2点を示す。
\begin{itemize}
\item Glide HTVSをフィルタリングに転用する手法では高速化の度合いが不十分であり、
	仮想的に化合物空間を広げたようなデータセットに対するドッキングなどを行う条件下では計算時間的に現実的ではない
\item 化合物ベースの手法(含Pharmacophore)は構造ベースよりも一般に高速だが、既知阻害剤があることが条件になり、
	さらに得られる化合物は既知の化合物に似てしまうという問題がある（前述した通り～みたいな感じで）
\end{itemize}

%\begin{figure}[htb]
% \begin{center}
%  \fig[width=0.6\hsize]{./fig/background/ドッキングの探索自由度.eps}
%  \caption{ドッキングシミュレーションにおける探索空間}
%  \label{fig:docking_freedom}
% \end{center}
%\end{figure}

